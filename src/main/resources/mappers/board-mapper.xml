<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="boardMapper">

 	<resultMap type="Board" id="boardResultSet">
		<result column="BOARD_NO" property="boardNo" />
		<result column="CATEGORY_NO" property="categoryNo" />
		<result column="FILE_NO" property="fileNo" />
		<result column="BREED_ID" property="breedId" />
		<result column="BOARD_TITLE" property="boardTitle" />
		<result column="USER_ID" property="boardWriter" />
		<result column="BOARD_CONTENT" property="boardContent" />
		<result column="COUNT" property="count" />
		<result column="RECOMMEND" property="recommend" />
		<result column="UPLOAD_DATE" property="uploadDate" />
		<result column="REVISE_DATE" property="reviseDate" />
		<result column="STATUS" property="status" />
	</resultMap> 

	<select id="listCount" resultType="_int" parameterType="com.kh.pjtMungHub.board.model.vo.ParameterVo">
		SELECT COUNT(*)
		FROM BOARD
		WHERE STATUS ='Y'
		<if test="category != 0">
		AND CATEGORY_NO =#{categoryNo}
		</if>
	</select>
	<select id="selectList" resultType="Board" parameterType="com.kh.pjtMungHub.board.model.vo.ParameterVo">
		SELECT BOARD_NO boardNo
			,BOARD_TITLE boardTitle
			,USER_ID boardWriter
			,CATEGORY_NO category
			,COUNT count
			,UPLOAD_DATE uploadDate
			,B.STATUS
		FROM BOARD B
		JOIN MEMBER M ON M.USER_NO=B.BOARD_WRITER
		WHERE B.STATUS='Y'
	<if test="category!=0">
		AND CATEGORY_NO = #{category}
	</if>
 		ORDER BY
		<choose>
			<when test="sort == 'latest'">
				UPLOAD_DATE DESC
			</when>
			<when test="sort == 'view'">
				COUNT DESC
			</when>
			<otherwise>
				UPLOAD_DATE DESC
			</otherwise>
		</choose>

	</select>

	<select id="selectCategory"
		resultType="com.kh.pjtMungHub.board.model.vo.Category">
		SELECT CATEGORY_NO categoryNo
			  ,CATEGORY_NAME categoryName
		FROM BOARD_CATEGORY
	</select>

	<update id="increaseCount" parameterType="_int">
		UPDATE B.BOARD
		SET COUNT=COUNT+1
		WHERE B.BOARD_NO=#{boardNo}
		AND B.STATUS ='Y'
	</update>
	<select id="selectBoard" parameterType="_int"
		resultMap="boardResultSet">
		SELECT BOARD_NO
				,BOARD_TITLE
				,BOARD_WRITER
				,BOARD_CONTENT
				,UPLOAD_DATE
				,COUNT
		FROM BOARD
		WHERE BOARD_NO = #{boardNo}
		AND STATUS ='Y'
	</select>

	<insert id="insertBoard" parameterType="Board">
		INSERT INTO
		BOARD(BOARD_NO
		,BOARD_TITLE
		,BOARD_WRITER
		,BOARD_CONTENT
		)
		VALUES (SEQ_BOARD.NEXTVAL
		,#{boardTitle}
		,#{boardWriter}
		,#{boardContent}
	</insert>

</mapper>